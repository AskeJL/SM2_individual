grammar greenhouse.GreenHouse with org.eclipse.xtext.common.Terminals

generate greenHouse "http://www.GreenHouse.greenhouse"

Model:
	"system" name=ID
	greenhouses+=Greenhouse*
;
	
	
Greenhouse:
	'greenhouse' name=ID
	'[' row+=Row* elements+=GreenhouseElement* ']'
;

Row:
	'row' name=ID 'includes' 
	'[' elements+=RowElement* ']'
;

GreenhouseElement:
	 GreenhouseSensor |  GreenhouseActuator |  RuleSet
;

RowElement:
	 Sensor |  Actuator
;


GreenhouseActuator:
	  'global' 'actuator' name=ID ('can' action+=Action)? (',' 'can' action+=Action)* 
;

Actuator:
	 name=ID ('can' action+=Action)? (',' 'can' action+=Action)* 
;

GreenhouseSensor:
	 'global' 'sensor'name=ID 'has' 'value' variable=Variable
		states+=State(',' states+=State)*
;

Sensor:
	name=ID 'has' 'value' variable=Variable
		states+=State(',' states+=State)*
;

State:
	name=ID 'when' variable=[Variable] op = ('<' | '>' | '=') threshold=INT
;

Variable:
	'variable' name=ID
;

Action:
	name=ID 'when' 'receiving' trigger=Trigger 'by' 'setting' setting=Setting 'to' value=Value
;

Trigger:
	{Trigger} name=STRING 
;
Setting:
	{Setting}
	name=STRING 
;

Value:
	{Value}
	name=INT 
;

RuleSet:
	'rule' actuator=[Actuator] 'set' action=[Action] 'when' sensor=[Sensor] 'is' state=[State]
;
